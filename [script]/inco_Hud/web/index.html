<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://kit-pro.fontawesome.com/releases/v6.1.1/css/pro.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.3.0/css/all.css" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <link href="style.css" rel="stylesheet">
    <title>FC3.0-Hud</title>
</head>

<body>
    <div class="ProgressBar">
        <span class="ProgressText">Przeszukiwanie...</span>
        <div class="Bar">
            <div class="BarFill"></div>
        </div>
    </div>
    <div class="Notifications"></div>
    <div class="CinemaTop"></div>
    <div class="CinemaBot"></div>
    <div class="Main" style="overflow: hidden;">
        <div class="MainHud">
            <div class="Square2" id="HealthSquare">
                <div class="Square3" id="HealthFill">
                    <div class="SquareBG2">
                        <i class="fa-solid fa-heart-pulse"></i>
                    </div>
                </div>
            </div>
            <div class="Square2" id="ShieldSquare">
                <div class="Square3" id="ShieldFill">
                    <div class="SquareBG2">
                            <i class="fa-solid fa-shield-heart"></i>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="Square2" id="FoodSquare">
                <div class="Square3" id="FoodFill">
                    <div class="SquareBG2">
                            <i class="fa-solid fa-burger"></i>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="Square2" id="WaterSquare">
                <div class="Square3" id="WaterFill">
                    <div class="SquareBG2">
                            <i class="fa-solid fa-bottle-water"></i>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="Square2" id="microphoneSquare">
                <div class="Square3" id="microphoneFill">
                    <div class="SquareBG2">
                            <i class="fa-solid fa-microphone-lines"></i>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    <div class="EditHud">
        <h1 style="text-align: center;">Opcje</h1>
        <div class="Settings" style="height: 70%; overflow: scroll; padding: 4vh;">
            <h3 style="text-align: center;">Ukryj ikony</h3>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="HealthCheck">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj zdrowie</span>
            </div>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="ShieldCheck">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj kamizelke</span>
            </div>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="FoodCheck">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj głód</span>
            </div>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="WaterCheck">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj pragnienie</span>
            </div>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="microphoneCheck">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj mikrofon</span>
            </div>
            <h3 style="text-align: center;">Inne</h3>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="HideHud">
                    <span class="slider round"></span>
                </label>
                <span>Ukryj Hud</span>
            </div>
            <div class="HideIcon">
                <label class="switch">
                    <input type="checkbox" id="CinemaMode">
                    <span class="slider round"></span>
                </label>
                <span>Tryb Kinowy</span>
                <input id="CinemaHeight" type="number" max="90">
                <span id="CinemaSpan" style="display: none;">%</span>
            </div>
        </div>
    </div>
    <body>
        <div class="carHud">
            <div class="SpeedContainer">
                <span id="speed"></span>
                <div class="progress" id="rpm"><div class="progressValue"></div></div>
                <div class="cards">
                    <div class="card card-left">
                        <div class="card-icon">
                            <i class="fa-regular fa-compass"></i>
                        </div>
                        <div class="card-content">
                            <span id="heading"></span>
                            <span id="street"></span>
                        </div>
                    </div>
                    <div class="card card-right">
                        <div class="card-icon">
                            <i class="fa-solid fa-gas-pump"></i>
                        </div>
                        <div class="card-content">
                            <span id="fuelLevel"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</body>
<script>
    let HiddenHud = false
    let CinemaMode = false
    let HiddenShield = false
    let InPauseMenu = false

    window.addEventListener("message", (event) => {
        switch (event.data.action) {
            case 'ShowHud':
                $('.carHud').animate({
                    bottom: '-12%'
                }, 500)
                break;

            case 'UpdateHud':
                $('#HealthFill').css('height', event.data.health + '%')
                $('#FoodFill').css('height', event.data.hunger + '%')
                $('#WaterFill').css('height', event.data.water + '%')

                if (event.data.armor > 1 && HiddenShield == false) {
                    $('#ShieldSquare').fadeIn(100)
                    $('#ShieldFill').css('height', event.data.armor + '%')
                } else {
                    $('#ShieldSquare').fadeOut(100)
                }

                if (event.data.microphone == 'Whisper' && event.data.state == false) {
                    $('#microphoneFill').css('height', '25%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(34, 147, 147) 0%, rgb(6, 72, 71) 100%)')
                }
                else if (event.data.microphone == 'Normal' && event.data.state == false) {
                    $('#microphoneFill').css('height', '45%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(34, 147, 147) 0%, rgb(6, 72, 71) 100%)')
                }
                else if (event.data.microphone == 'Shouting' && event.data.state == false) {
                    $('#microphoneFill').css('height', '100%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(34, 147, 147) 0%, rgb(6, 72, 71) 100%)')
                }
                else if (event.data.microphone == 'Whisper' && event.data.state == true) {
                    $('#microphoneFill').css('height', '25%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(49, 52, 222) 0%, rgb(11, 20, 71) 100%)')
                }
                else if (event.data.microphone == 'Normal' && event.data.state == true) {
                    $('#microphoneFill').css('height', '45%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(49, 52, 222) 0%, rgb(11, 20, 71) 100%)')
                }
                else if (event.data.microphone == 'Shouting' && event.data.state == true) {
                    $('#microphoneFill').css('height', '100%')
                    $('#microphoneFill').css('background-image', 'linear-gradient(180deg, rgb(49, 52, 222) 0%, rgb(11, 20, 71) 100%)')
                }
                break;

            case 'UpdateCarHud':
                $('.carHud').animate({
                    bottom: '1%'
                }, 500)
                break;

            case 'HideCarHud':
                $('.carHud').animate({
                    bottom: '-12%'
                }, 500)
                break;

            case 'OpenEditHud':
                $('.EditHud').css('display', 'block')
                break;

            case 'HideEditHud':
                $('.EditHud').css('display', 'none')
                break;

            case 'SendNotify':
                var $Notify = $('<div class="Notify">' + event.data.text + '</div>')
                $('.Notifications').append($Notify)
                $Notify.animate({
                    marginRight: '0vh',
                    marginLeft: 'auto'
                },
                    {
                        duration: 700,
                        complete: setTimeout(() => {
                            $Notify.animate({
                                marginRight: '-120vh',
                            })
                        }, event.data.timeout - 100)
                    })
                setTimeout(() => {
                    $Notify.remove()
                    $.post('http://FC3.0-Hud/EndNotify', JSON.stringify({}))
                }, event.data.timeout);
                break;

            case 'CreateProgress':
                $('.ProgressText').text(event.data.label)
                $('.ProgressBar').animate({
                    bottom: '8%'
                }, 200)
                $('.BarFill').animate({
                    width: '100%'
                }, {
                    duration: event.data.time,
                    complete: function () {
                        $('.ProgressBar').animate({
                            bottom: '-10%'
                        })
                        setTimeout(() => {
                            $('.BarFill').css('width', '0%')
                        }, 200);
                        $.post('http://FC3.0-Hud/ProgBarComplete', JSON.stringify({}))
                    }
                })
                break;

            case 'CancelProgress':
                $('.BarFill').css('width', '0%')
                $('.ProgressBar').animate({
                    bottom: '-10%'
                })
                break;
        }
    })

    $('#HealthCheck').click(() => {
        if ($('#HealthCheck')[0].checked == true) {
            $('#HealthSquare').css('display', 'none')
        } else {
            $('#HealthSquare').css('display', 'block')
        }
    })

    $('#ShieldCheck').click(() => {
        if ($('#ShieldCheck')[0].checked == true) {
            $('#ShieldSquare').css('display', 'none')
            HiddenShield = true
        } else {
            $('#ShieldSquare').css('display', 'block')
            HiddenShield = false
        }
    })

    $('#FoodCheck').click(() => {
        if ($('#FoodCheck')[0].checked == true) {
            $('#FoodSquare').css('display', 'none')
        } else {
            $('#FoodSquare').css('display', 'block')
        }
    })

    $('#WaterCheck').click(() => {
        if ($('#WaterCheck')[0].checked == true) {
            $('#WaterSquare').css('display', 'none')
        } else {
            $('#WaterSquare').css('display', 'block')
        }
    })

    $('#microphoneCheck').click(() => {
        if ($('#microphoneCheck')[0].checked == true) {
            $('#microphoneSquare').css('display', 'none')
        } else {
            $('#microphoneSquare').css('display', 'block')
        }
    })

    $('#CinemaMode').click(() => {
        if ($('#CinemaMode')[0].checked == true) {
            CinemaMode = true
            $('#HideHud')[0].checked = false
            $.post('http://FC3.0-Hud/CinemaModeOn', JSON.stringify({}))
            $('.MainHud').css('display', 'none')
            $('.carHud').css('display', 'none')
            $('.CinemaTop').css('display', 'block')
            $('.CinemaBot').css('display', 'block')
            $('#CinemaHeight').css('display', 'block')
            $('#CinemaSpan').css('display', 'block')
        } else {
            CinemaMode = false
            $.post('http://FC3.0-Hud/CinemaModeOff', JSON.stringify({}))
            $('.MainHud').css('display', 'flex')
            $('.carHud').css('display', 'flex')
            $('.CinemaTop').css('display', 'none')
            $('.CinemaBot').css('display', 'none')
            $('#CinemaHeight').css('display', 'none')
            $('#CinemaSpan').css('display', 'none')
        }
    })

    $('#HideHud').click(() => {
        if ($('#HideHud')[0].checked == true) {
            $('#CinemaMode')[0].checked = false
            HiddenHud = true
            $('.MainHud').css('display', 'none')
            $('.carHud').css('display', 'none')
        } else {
            HiddenHud = false
            $('.MainHud').css('display', 'flex')
            $('.carHud').css('display', 'flex')
        }
    })

    var CinemaInput = document.getElementById('CinemaHeight')

    CinemaInput.oninput = function () {
        var height = $('#CinemaHeight').val()
        console.log(height)
        $('.CinemaTop').css('height', height + '%')
        $('.CinemaBot').css('height', height + '%')
    }

    document.onkeydown = function (data) {
        if (data.which == 27) {
            $('.EditHud').css('display', 'none')
            $.post('http://FC3.0-Hud/CloseEditHud', JSON.stringify({}))
        }
    }

    window.addEventListener("message", function (event) {
    var item = event.data
    switch (item.process) {
        case 'show':
            $('.speedometer').css({'transform': `translateY(0)`})
            // padStart(3, '0')
            let speed = Math.round(item.speedLevel).toString()
            $("#speed").html(speed.padStart(3, '0') + ' <span>MPH</span>')
            $("#fuelLevel").html(Math.round(item.fuel)+'%')
            $("#heading").text(item.heading)
            $("#street").text(item.streetName)

            $('.progressValue').css('width', Math.round(item.rpmLevel)+'%')
        break
    }
})

window.onload = function() {
    $.post(`http://${GetParentResourceName()}/getPlayerId`, function(cb) {
        $('#playerId').html(cb)
    })
}

</script>

</html>